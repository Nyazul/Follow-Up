<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <title>Remaining Follow-Ups</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

  <link rel="stylesheet" th:href="@{main.css}">

</head>

<body class="d-flex flex-column min-vh-100">
  <!-- Navbar -->

  <div th:replace="~{/navbar :: navbar('FOLLOWUP-EMPLOYEE', 'remaining')}"></div>


  <div class="content">

    <div th:if="*{message!=null and #strings.length(message)>0}" class="alert text-danger text-center"
      th:text="${message}"></div>

    <!-- Section Title -->
    <div class="section-title">Remaining Follow-up</div>

    <!-- Main Content Placeholder -->
    <div id="mainContent">

      <div class="section-title" th:if="${user.remainingFollowUps == null or #lists.isEmpty(user.remainingFollowUps)}">
        <span class="alert alert-success">ðŸ˜Š No follow-ups remaining</span>
      </div>

      <!-- Lead Cards -->
      <div class="lead-card" th:each="followUp : ${user.remainingFollowUps}" th:attr="data-id=${followUp.id}">
        <div class="lead-info">
          <div class="lead-icon">ðŸ‘¤</div>
          <div class="lead-text">
            <div class="lead-title" th:text="${followUp.lead.name}">Lead 1</div>
            <div><strong>Follow Up:</strong><span th:utext="${followUp.recentNodeTitleAndBody}">Details</span></div>
            <div><strong>Next Follow-up:</strong><span
                th:text="${followUp.dueDate != null ? #temporals.format(followUp.dueDate, 'dd MMM yyyy HH:mm') : 'No Date'}">3
                April</span></div>
            <div><strong>Course:</strong><span th:text="${followUp.course.name}">BSc Computer Science</span></div>
            <div><strong>Department:</strong><span th:text="${followUp.course.department.name}">Science</span></div>
            <div><strong>Mobile:</strong><span th:text="${followUp.lead.phoneNumber}">8551055201</span></div>
            <div><strong>Email:</strong><span th:text="${followUp.lead.email}">xyz2003@gmail.com</span></div>
            <div><strong>Address:</strong><span th:text="${followUp.lead.address}">Nashik</span></div>
          </div>
        </div>
        <div class="arrow-btn">âž¤</div>
      </div>

      <!-- Click Redirect Script -->
      <script>
        document.addEventListener("DOMContentLoaded", function () {
          const leadCards = document.querySelectorAll(".lead-card");

          leadCards.forEach(card => {
            card.addEventListener("click", function () {
              const followUpId = this.getAttribute("data-id");
              if (followUpId) {
                window.location.href = `/remaining-followup/${followUpId}`;
              }
            });
          });
        });
      </script>

    </div>

    <!-- Add Button -->
    <button class="add-btn" onclick="window.location.href='/new-followup'">+</button>

  </div>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script th:src="@{/main.js}"></script>

</body>

</html>